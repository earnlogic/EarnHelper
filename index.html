<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EarnHelper PRO</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --neon-green: #2ecc71; --dark-bg: #0b0b0b; --card-bg: #161616; --text-gray: #9ca3af; }
        body { font-family: 'Inter', sans-serif; background: var(--dark-bg); color: white; margin: 0; padding-bottom: 80px; }
        .container { padding: 20px; max-width: 480px; margin: auto; }
        
        /* Dashboard Card */
        .stat-card { background: #1a1a1a; border-radius: 20px; padding: 25px; text-align: center; margin-bottom: 20px; border: 1px solid #222; }
        .task-card { background: var(--card-bg); padding: 15px; border-radius: 15px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #222; }

        /* Floating AI Widget (Corner Style) */
        #ai-widget { position: fixed; bottom: 90px; right: 20px; width: 60px; height: 60px; background: var(--neon-green); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4); z-index: 2000; transition: 0.3s; }
        #ai-chat-window { display: none; position: fixed; bottom: 160px; right: 20px; width: 300px; height: 400px; background: #111; border-radius: 15px; border: 1px solid #333; flex-direction: column; z-index: 2001; box-shadow: 0 10px 30px rgba(0,0,0,0.8); overflow: hidden; }
        .ai-header { background: #222; padding: 12px; display: flex; justify-content: space-between; align-items: center; font-weight: bold; font-size: 14px; border-bottom: 1px solid #333; }
        #ai-messages { flex: 1; overflow-y: auto; padding: 10px; display: flex; flex-direction: column; gap: 8px; font-size: 13px; }
        .msg { padding: 8px 12px; border-radius: 12px; max-width: 80%; line-height: 1.4; }
        .u-msg { align-self: flex-end; background: var(--neon-green); color: black; }
        .b-msg { align-self: flex-start; background: #222; border: 1px solid #333; }
        .ai-input { padding: 10px; background: #000; border-top: 1px solid #333; display: flex; gap: 5px; }
        .ai-input input { flex: 1; background: #1a1a1a; border: none; color: white; padding: 8px; border-radius: 5px; outline: none; }

        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #000; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #222; z-index: 1000; }
        .nav-item { color: var(--text-gray); text-align: center; font-size: 11px; cursor: pointer; flex: 1; text-decoration: none; }
        .nav-item.active { color: var(--neon-green); }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

<div id="main-content" class="container">
    <div class="stat-card">
        <p style="color: var(--text-gray);">Total Balance</p>
        <h1 style="color: var(--neon-green); font-size: 40px; margin: 10px 0;">৳ <span id="balance">0.00</span></h1>
        <div style="font-size: 12px; background: #333; padding: 4px 12px; border-radius: 20px;">BRONZE</div>
    </div>

    <h3>Active Tasks</h3>
    <div class="task-card">
        <div>
            <div style="font-weight: bold;">Daily Check-in</div>
            <div style="font-size: 12px; color: var(--text-gray);">Get your daily reward</div>
        </div>
        <div style="color: var(--neon-green); font-weight: bold;">+৳ 10</div>
    </div>
</div>

<div id="ai-widget" onclick="toggleAI()"><i class="fa fa-robot" style="color: black; font-size: 24px;"></i></div>

<div id="ai-chat-window">
    <div class="ai-header">
        <span><i class="fa fa-robot"></i> AI Assistant</span>
        <i class="fa fa-times" onclick="toggleAI()" style="cursor:pointer"></i>
    </div>
    <div id="ai-messages">
        <div class="msg b-msg">Hello! How can I help you earn today?</div>
    </div>
    <div class="ai-input">
        <input type="text" id="ai-user-input" placeholder="Type here...">
        <button onclick="askAI()" style="background: var(--neon-green); border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;"><i class="fa fa-paper-plane"></i></button>
    </div>
</div>

<div class="bottom-nav">
    <div class="nav-item active"><i class="fa fa-home"></i>Home</div>
    <div class="nav-item" onclick="alert('Redirecting to Tasks...')"><i class="fa fa-tasks"></i>Tasks</div>
    <div class="nav-item" onclick="alert('Withdraw Section Loading...')"><i class="fa fa-wallet"></i>Withdraw</div>
    <div class="nav-item" onclick="location.reload()"><i class="fa fa-sign-out-alt"></i>Exit</div>
</div>

<script>
    // Supabase Config
    const sURL = 'https://xserxssnjdshehrefhvr.supabase.co';
    const sKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhzZXJ4c3NuamRzaGVocmVmaHZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4MzY4MTgsImV4cCI6MjA4NzQxMjgxOH0.Dow2NjohUNLgpDluVKcV4TBACCpDyCa31BH-tdLYik8';
    const supabaseClient = supabase.createClient(sURL, sKey);

    function toggleAI() {
        const win = document.getElementById('ai-chat-window');
        win.style.display = (win.style.display === 'flex') ? 'none' : 'flex';
    }

    async function askAI() {
        const input = document.getElementById('ai-user-input');
        const box = document.getElementById('ai-messages');
        if(!input.value) return;

        box.innerHTML += `<div class="msg u-msg">${input.value}</div>`;
        const userText = input.value;
        input.value = "";
        box.scrollTop = box.scrollHeight;

        const botMsgId = "bot-" + Date.now();
        box.innerHTML += `<div class="msg b-msg" id="${botMsgId}">Thinking...</div>`;

        try {
            // Using a sample Gemini Key (Update this with your own working key)
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyBduk7N7im9_Lm2FqRCsyPdS6ZHL665wY4`, {
                method: "POST", headers: {"Content-Type": "application/json"},
                body: JSON.stringify({ contents: [{ parts: [{ text: userText }] }] })
            });
            const d = await res.json();
            document.getElementById(botMsgId).innerText = d.candidates[0].content.parts[0].text;
        } catch(e) {
            document.getElementById(botMsgId).innerText = "AI service unavailable. Check API Key.";
        }
        box.scrollTop = box.scrollHeight;
    }
</script>
</body>
</html>
